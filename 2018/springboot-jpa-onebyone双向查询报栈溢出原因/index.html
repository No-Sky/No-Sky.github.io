<!doctype html><html lang=en-us><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="chrome=1"><meta name=viewport content="width=device-width,initial-scale=1"><link rel="shortcut icon" href=https://no-sky.github.io/images/favicon.ico><meta name=robots content="noodp"><meta name=author content="nosky"><meta name=description content="nosky 的个人学习笔记"><meta name=keywords content="[note 笔记 nosky]"><link rel=prev href=https://no-sky.github.io/2018/maven%E4%B8%8Eeclipse/><link rel=next href=https://no-sky.github.io/2019/spatial-rectangular-coordinate-system/><link rel=canonical href=https://no-sky.github.io/2018/springboot-jpa-onebyone%E5%8F%8C%E5%90%91%E6%9F%A5%E8%AF%A2%E6%8A%A5%E6%A0%88%E6%BA%A2%E5%87%BA%E5%8E%9F%E5%9B%A0/><meta name=msapplication-TileColor content="#da532c"><meta name=theme-color content="#ffffff"><title>SpringBoot Jpa @OneByOne双向查询报栈溢出原因 | Note</title><meta name=title content="SpringBoot Jpa @OneByOne双向查询报栈溢出原因 | Note"><link rel=stylesheet href=/font/iconfont.css><link rel=stylesheet href=/css/main.min.css><script type=application/ld+json>{"@context":"http://schema.org","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"https:\/\/no-sky.github.io"},"articleSection":"posts","name":"SpringBoot Jpa @OneByOne双向查询报栈溢出原因","headline":"SpringBoot Jpa @OneByOne双向查询报栈溢出原因","description":"示例：\n@Data @Entity public class User { @Id @GeneratedValue(strategy = GenerationType.IDENTITY) private Integer uid; \/**用户名*\/ private String username; \/**用户密码*\/ private String password; \/**注册时间*\/ private Timestamp regTime; \/**性别*\/ private Boolean sex; @OneToOne(cascade = CascadeType.ALL) @JoinColumn(name = \x26#34;weixin\x26#34;) private WXToken wxToken; } @Data @Entity public class WXToken { \/**微信号*\/ @Id private String weixin; \/**微信token授权*\/ private String token; \/**授权开始时间*\/ private Timestamp startTime; \/**授权过期时间*\/ private Timestamp expireTime; @OneToOne(mappedBy = \x26#34;wxToken\x26#34;, cascade = CascadeType.ALL) private User user; } 报错：","inLanguage":"en-us","author":"nosky","creator":"nosky","publisher":"nosky","accountablePerson":"nosky","copyrightHolder":"nosky","copyrightYear":"2018","datePublished":"2018-10-14 22:59:46 \x2b0000 UTC","dateModified":"2018-10-14 22:59:46 \x2b0000 UTC","url":"https:\/\/no-sky.github.io\/2018\/springboot-jpa-onebyone%E5%8F%8C%E5%90%91%E6%9F%A5%E8%AF%A2%E6%8A%A5%E6%A0%88%E6%BA%A2%E5%87%BA%E5%8E%9F%E5%9B%A0\/","wordCount":"107","keywords":["springboot-data-jpa","Note"]}</script><script type=text/javascript async src="https://cdn.bootcss.com/mathjax/2.7.3/MathJax.js?config=TeX-AMS-MML_HTMLorMML">MathJax.Hub.Config({tex2jax:{inlineMath:[['$','$'],['\\(','\\)']],displayMath:[['$$','$$'],['\[','\]']],processEscapes:true,processEnvironments:true,skipTags:['script','noscript','style','textarea','pre'],TeX:{equationNumbers:{autoNumber:"AMS"},extensions:["AMSmath.js","AMSsymbols.js"]}},"HTML-CSS":{linebreaks:{automatic:true}},SVG:{linebreaks:{automatic:true}}});MathJax.Hub.Queue(function(){var all=MathJax.Hub.getAllJax(),i;for(i=0;i<all.length;i+=1){all[i].SourceElement().parentNode.className+=' has-jax';}});</script><style>code.has-jax{font:inherit;font-size:100%;background:inherit;border:inherit;color:#515151}</style></head><body><div class=wrapper><nav class=navbar><div class=container><div class="navbar-header header-logo"><a href=javascript:void(0); class=theme-switch><i class="iconfont icon-xihuan"></i></a>&nbsp;<a href=https://no-sky.github.io>Note</a></div><div class="menu navbar-right"><a class=menu-item href=/posts/>Blog</a>
<a class=menu-item href=/tags/>Tags</a></div></div></nav><nav class=navbar-mobile id=nav-mobile style=display:none><div class=container><div class=navbar-header><div><a href=javascript:void(0); class=theme-switch><i class="iconfont icon-xihuan"></i></a>&nbsp;<a href=https://no-sky.github.io>Note</a></div><div class=menu-toggle><span></span><span></span><span></span></div></div><div class=menu id=mobile-menu><a class=menu-item href=/posts/>Blog</a>
<a class=menu-item href=/tags/>Tags</a></div></div></nav><main class=main><div class=container><article class=post-warp itemscope itemtype=http://schema.org/Article><header class=post-header><h1 class=post-title itemprop="name headline">SpringBoot Jpa @OneByOne双向查询报栈溢出原因</h1><div class=post-meta>Written by <a itemprop=name href=https://no-sky.github.io rel=author>nosky</a> with ♥
<span class=post-time>on <time datetime=2018-10-14 itemprop=datePublished>October 14, 2018</time></span>
in</div></header><div class=post-content><p>示例：</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=color:#a6e22e>@Data</span>
<span style=color:#a6e22e>@Entity</span>
<span style=color:#66d9ef>public</span> <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>User</span> <span style=color:#f92672>{</span>
    <span style=color:#a6e22e>@Id</span>
    <span style=color:#a6e22e>@GeneratedValue</span><span style=color:#f92672>(</span>strategy <span style=color:#f92672>=</span> GenerationType<span style=color:#f92672>.</span><span style=color:#a6e22e>IDENTITY</span><span style=color:#f92672>)</span>
    <span style=color:#66d9ef>private</span> Integer uid<span style=color:#f92672>;</span>

    <span style=color:#75715e>/**用户名*/</span>
    <span style=color:#66d9ef>private</span> String username<span style=color:#f92672>;</span>

    <span style=color:#75715e>/**用户密码*/</span>
    <span style=color:#66d9ef>private</span> String password<span style=color:#f92672>;</span>

    <span style=color:#75715e>/**注册时间*/</span>
    <span style=color:#66d9ef>private</span> Timestamp regTime<span style=color:#f92672>;</span>

    <span style=color:#75715e>/**性别*/</span>
    <span style=color:#66d9ef>private</span> Boolean sex<span style=color:#f92672>;</span>

    <span style=color:#a6e22e>@OneToOne</span><span style=color:#f92672>(</span>cascade <span style=color:#f92672>=</span> CascadeType<span style=color:#f92672>.</span><span style=color:#a6e22e>ALL</span><span style=color:#f92672>)</span>
    <span style=color:#a6e22e>@JoinColumn</span><span style=color:#f92672>(</span>name <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;weixin&#34;</span><span style=color:#f92672>)</span>
    <span style=color:#66d9ef>private</span> WXToken wxToken<span style=color:#f92672>;</span>
<span style=color:#f92672>}</span>
</code></pre></div><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=color:#a6e22e>@Data</span>
<span style=color:#a6e22e>@Entity</span>
<span style=color:#66d9ef>public</span> <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>WXToken</span> <span style=color:#f92672>{</span>

    <span style=color:#75715e>/**微信号*/</span>
    <span style=color:#a6e22e>@Id</span>
    <span style=color:#66d9ef>private</span> String weixin<span style=color:#f92672>;</span>

    <span style=color:#75715e>/**微信token授权*/</span>
    <span style=color:#66d9ef>private</span> String token<span style=color:#f92672>;</span>

    <span style=color:#75715e>/**授权开始时间*/</span>
    <span style=color:#66d9ef>private</span> Timestamp startTime<span style=color:#f92672>;</span>

    <span style=color:#75715e>/**授权过期时间*/</span>
    <span style=color:#66d9ef>private</span> Timestamp expireTime<span style=color:#f92672>;</span>

    <span style=color:#a6e22e>@OneToOne</span><span style=color:#f92672>(</span>mappedBy <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;wxToken&#34;</span><span style=color:#f92672>,</span> cascade <span style=color:#f92672>=</span> CascadeType<span style=color:#f92672>.</span><span style=color:#a6e22e>ALL</span><span style=color:#f92672>)</span>
    <span style=color:#66d9ef>private</span> User user<span style=color:#f92672>;</span>
<span style=color:#f92672>}</span>
</code></pre></div><p>报错：</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java>java<span style=color:#f92672>.</span><span style=color:#a6e22e>lang</span><span style=color:#f92672>.</span><span style=color:#a6e22e>StackOverflowError</span>
	at java<span style=color:#f92672>.</span><span style=color:#a6e22e>lang</span><span style=color:#f92672>.</span><span style=color:#a6e22e>AbstractStringBuilder</span><span style=color:#f92672>.</span><span style=color:#a6e22e>append</span><span style=color:#f92672>(</span>AbstractStringBuilder<span style=color:#f92672>.</span><span style=color:#a6e22e>java</span><span style=color:#f92672>:</span>675<span style=color:#f92672>)</span>
	at java<span style=color:#f92672>.</span><span style=color:#a6e22e>lang</span><span style=color:#f92672>.</span><span style=color:#a6e22e>StringBuilder</span><span style=color:#f92672>.</span><span style=color:#a6e22e>append</span><span style=color:#f92672>(</span>StringBuilder<span style=color:#f92672>.</span><span style=color:#a6e22e>java</span><span style=color:#f92672>:</span>208<span style=color:#f92672>)</span>
	at java<span style=color:#f92672>.</span><span style=color:#a6e22e>sql</span><span style=color:#f92672>.</span><span style=color:#a6e22e>Timestamp</span><span style=color:#f92672>.</span><span style=color:#a6e22e>toString</span><span style=color:#f92672>(</span>Timestamp<span style=color:#f92672>.</span><span style=color:#a6e22e>java</span><span style=color:#f92672>:</span>302<span style=color:#f92672>)</span>
	at java<span style=color:#f92672>.</span><span style=color:#a6e22e>lang</span><span style=color:#f92672>.</span><span style=color:#a6e22e>String</span><span style=color:#f92672>.</span><span style=color:#a6e22e>valueOf</span><span style=color:#f92672>(</span>String<span style=color:#f92672>.</span><span style=color:#a6e22e>java</span><span style=color:#f92672>:</span>2994<span style=color:#f92672>)</span>
	at java<span style=color:#f92672>.</span><span style=color:#a6e22e>lang</span><span style=color:#f92672>.</span><span style=color:#a6e22e>StringBuilder</span><span style=color:#f92672>.</span><span style=color:#a6e22e>append</span><span style=color:#f92672>(</span>StringBuilder<span style=color:#f92672>.</span><span style=color:#a6e22e>java</span><span style=color:#f92672>:</span>131<span style=color:#f92672>)</span>
	at com<span style=color:#f92672>.</span><span style=color:#a6e22e>nosky</span><span style=color:#f92672>.</span><span style=color:#a6e22e>hnsoftshow</span><span style=color:#f92672>.</span><span style=color:#a6e22e>domain</span><span style=color:#f92672>.</span><span style=color:#a6e22e>WXToken</span><span style=color:#f92672>.</span><span style=color:#a6e22e>toString</span><span style=color:#f92672>(</span>WXToken<span style=color:#f92672>.</span><span style=color:#a6e22e>java</span><span style=color:#f92672>:</span>8<span style=color:#f92672>)</span>
	at java<span style=color:#f92672>.</span><span style=color:#a6e22e>lang</span><span style=color:#f92672>.</span><span style=color:#a6e22e>String</span><span style=color:#f92672>.</span><span style=color:#a6e22e>valueOf</span><span style=color:#f92672>(</span>String<span style=color:#f92672>.</span><span style=color:#a6e22e>java</span><span style=color:#f92672>:</span>2994<span style=color:#f92672>)</span>
	at java<span style=color:#f92672>.</span><span style=color:#a6e22e>lang</span><span style=color:#f92672>.</span><span style=color:#a6e22e>StringBuilder</span><span style=color:#f92672>.</span><span style=color:#a6e22e>append</span><span style=color:#f92672>(</span>StringBuilder<span style=color:#f92672>.</span><span style=color:#a6e22e>java</span><span style=color:#f92672>:</span>131<span style=color:#f92672>)</span>
	at com<span style=color:#f92672>.</span><span style=color:#a6e22e>nosky</span><span style=color:#f92672>.</span><span style=color:#a6e22e>hnsoftshow</span><span style=color:#f92672>.</span><span style=color:#a6e22e>domain</span><span style=color:#f92672>.</span><span style=color:#a6e22e>User</span><span style=color:#f92672>.</span><span style=color:#a6e22e>toString</span><span style=color:#f92672>(</span>User<span style=color:#f92672>.</span><span style=color:#a6e22e>java</span><span style=color:#f92672>:</span>10<span style=color:#f92672>)</span>
	at java<span style=color:#f92672>.</span><span style=color:#a6e22e>lang</span><span style=color:#f92672>.</span><span style=color:#a6e22e>String</span><span style=color:#f92672>.</span><span style=color:#a6e22e>valueOf</span><span style=color:#f92672>(</span>String<span style=color:#f92672>.</span><span style=color:#a6e22e>java</span><span style=color:#f92672>:</span>2994<span style=color:#f92672>)</span>
	at java<span style=color:#f92672>.</span><span style=color:#a6e22e>lang</span><span style=color:#f92672>.</span><span style=color:#a6e22e>StringBuilder</span><span style=color:#f92672>.</span><span style=color:#a6e22e>append</span><span style=color:#f92672>(</span>StringBuilder<span style=color:#f92672>.</span><span style=color:#a6e22e>java</span><span style=color:#f92672>:</span>131<span style=color:#f92672>)</span>
	at com<span style=color:#f92672>.</span><span style=color:#a6e22e>nosky</span><span style=color:#f92672>.</span><span style=color:#a6e22e>hnsoftshow</span><span style=color:#f92672>.</span><span style=color:#a6e22e>domain</span><span style=color:#f92672>.</span><span style=color:#a6e22e>WXToken</span><span style=color:#f92672>.</span><span style=color:#a6e22e>toString</span><span style=color:#f92672>(</span>WXToken<span style=color:#f92672>.</span><span style=color:#a6e22e>java</span><span style=color:#f92672>:</span>8<span style=color:#f92672>)</span>
	at java<span style=color:#f92672>.</span><span style=color:#a6e22e>lang</span><span style=color:#f92672>.</span><span style=color:#a6e22e>String</span><span style=color:#f92672>.</span><span style=color:#a6e22e>valueOf</span><span style=color:#f92672>(</span>String<span style=color:#f92672>.</span><span style=color:#a6e22e>java</span><span style=color:#f92672>:</span>2994<span style=color:#f92672>)</span>
<span style=color:#f92672>.</span><span style=color:#f92672>.</span><span style=color:#f92672>.</span>
</code></pre></div><p>原因：</p><p>​<strong>实体类的toString()方法被无限递归</strong></p><p>解决：</p><p>​<strong>去掉任意一个实体的toString()，或者两个都可去掉</strong></p><p><a href=https://www.v2ex.com/t/541510>V2EX有关这个类似问题的讨论与更加合理的解决方案</a></p></div><div class=post-copyright><p class=copyright-item><span>Author:</span>
<span>nosky</span></p><p class=copyright-item><span>Link:</span>
<a href=https://no-sky.github.io/2018/springboot-jpa-onebyone%E5%8F%8C%E5%90%91%E6%9F%A5%E8%AF%A2%E6%8A%A5%E6%A0%88%E6%BA%A2%E5%87%BA%E5%8E%9F%E5%9B%A0/>https://no-sky.github.io/2018/springboot-jpa-onebyone%E5%8F%8C%E5%90%91%E6%9F%A5%E8%AF%A2%E6%8A%A5%E6%A0%88%E6%BA%A2%E5%87%BA%E5%8E%9F%E5%9B%A0/</span></p><p class="copyright-item lincese">本文采用<a rel=license href=http://creativecommons.org/licenses/by-nc/4.0/ target=_blank>知识共享署名-非商业性使用 4.0 国际许可协议</a>进行许可</p></div><div class=post-tags><section><i class="iconfont icon-tag"></i>Tag(s):
<span class=tag><a href=https://no-sky.github.io/tags/springboot-data-jpa/>#springboot-data-jpa</a></span></section><section><a href=javascript:window.history.back();>back</a></span> ·
<span><a href=https://no-sky.github.io>home</a></span></section></div><div class=post-nav><a href=https://no-sky.github.io/2018/maven%E4%B8%8Eeclipse/ class=prev rel=prev title=Maven与eclipse><i class="iconfont icon-left"></i>&nbsp;Maven与eclipse</a>
<a href=https://no-sky.github.io/2019/spatial-rectangular-coordinate-system/ class=next rel=next title=空间直角坐标系>空间直角坐标系&nbsp;<i class="iconfont icon-right"></i></a></div><div class=post-comment></div></article></div></main><footer class=footer><div class=copyright>&copy;
<span itemprop=copyrightYear>2016 - 2020</span>
<span class=with-love><i class="iconfont icon-love"></i></span><span class=author itemprop=copyrightHolder><a href=https://no-sky.github.io>nosky</a> |</span>
<a href=http://beian.miit.gov.cn/ target=_blank rel="external nofollow">湘ICP备19027112号</a> |
<span>Powered by <a href=https://gohugo.io/ target=_blank rel="external nofollow">Hugo</a> & <a href=https://github.com/liuzc/leaveit target=_blank rel="external nofollow">LeaveIt</a></span></br><span><a href=https://www.upyun.com/><img style=width:80px;height:30px;background-color:#70847d src=/images/upyun.png alt></a></span></div></footer><script src=/js/vendor_no_gallery.min.js async></script></div></body></html>