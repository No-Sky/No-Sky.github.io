<!doctype html><html lang=en-us><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="chrome=1"><meta name=viewport content="width=device-width,initial-scale=1"><link rel="shortcut icon" href=https://no-sky.github.io/images/favicon.ico><meta name=robots content="noodp"><meta name=author content="nosky"><meta name=description content="nosky 的个人学习笔记"><meta name=keywords content="[note 笔记 nosky]"><link rel=prev href=https://no-sky.github.io/2017/oracle%E7%AC%94%E8%AE%B0-%E5%85%AD/><link rel=next href=https://no-sky.github.io/2017/oracle%E7%AC%94%E8%AE%B0-%E5%85%AB/><link rel=canonical href=https://no-sky.github.io/2017/oracle%E7%AC%94%E8%AE%B0-%E4%B8%83/><meta name=msapplication-TileColor content="#da532c"><meta name=theme-color content="#ffffff"><title>Oracle笔记 （七） | Note</title><meta name=title content="Oracle笔记 （七） | Note"><link rel=stylesheet href=/font/iconfont.css><link rel=stylesheet href=/css/main.min.css><script type=application/ld+json>{"@context":"http://schema.org","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"https:\/\/no-sky.github.io"},"articleSection":"posts","name":"Oracle笔记 （七）","headline":"Oracle笔记 （七）","description":"多表连接（二）、组函数、分组查询 一、不等连接 拿一个表作为另一表的查询条件或范围\n如：显示雇员名称，工资和所属工资等级。\nselect e.ename,e.sal,s.grade from emp e,salgrade s where e.sal between s.losal and s.hisal; 二、自连接 自连接就是一个表，同本身进行连接。对于自连接可以想像存在两个相同的表(表和表的副本)，可以通过不同的别名区别两个相同的表（其它就是内连接)\n如：显示雇员名称和雇员的经理名称\nselect worker.ename||\x26#39;的经理是\x26#39;||manager.ename as 雇员经理 from emp worker,emp manager where worker.mgr=manager.empno; 三、组函数 ** 组函数只能应用于SELECT子句、HAVING子句或ORDER BY子句中。 组函数也可以称为统计函数。 组函数忽略列的空值。 对组可以应用组函数。 在组函数中可使用DISTINCT或ALL关键字。 ALL表示对所有非NULL值(可重复)进行运算。 DISTINCT 表示对每一个非NULL值，如果存在重复值，则组函数只运算一次。如果不指明上述关键字，默认为ALL。 **\n   函数 说明     AVG 求平均值   COUNT 求计数值，返回非空行数，*表示返回所有行   MAX 求最大值   MIN 求最小值   SUM 求和   SIDDEV 求标准偏差，是根据差的平方根得到的   VARIANCE 求统计方差    四、分组查询 1、如：按职务统计工资总和。","inLanguage":"en-us","author":"nosky","creator":"nosky","publisher":"nosky","accountablePerson":"nosky","copyrightHolder":"nosky","copyrightYear":"2017","datePublished":"2017-11-27 19:20:34 \x2b0000 UTC","dateModified":"2017-11-27 19:20:34 \x2b0000 UTC","url":"https:\/\/no-sky.github.io\/2017\/oracle%E7%AC%94%E8%AE%B0-%E4%B8%83\/","wordCount":"116","keywords":["oracel","Note"]}</script><script type=text/javascript async src="https://cdn.bootcss.com/mathjax/2.7.3/MathJax.js?config=TeX-AMS-MML_HTMLorMML">MathJax.Hub.Config({tex2jax:{inlineMath:[['$','$'],['\\(','\\)']],displayMath:[['$$','$$'],['\[','\]']],processEscapes:true,processEnvironments:true,skipTags:['script','noscript','style','textarea','pre'],TeX:{equationNumbers:{autoNumber:"AMS"},extensions:["AMSmath.js","AMSsymbols.js"]}},"HTML-CSS":{linebreaks:{automatic:true}},SVG:{linebreaks:{automatic:true}}});MathJax.Hub.Queue(function(){var all=MathJax.Hub.getAllJax(),i;for(i=0;i<all.length;i+=1){all[i].SourceElement().parentNode.className+=' has-jax';}});</script><style>code.has-jax{font:inherit;font-size:100%;background:inherit;border:inherit;color:#515151}</style></head><body><div class=wrapper><nav class=navbar><div class=container><div class="navbar-header header-logo"><a href=javascript:void(0); class=theme-switch><i class="iconfont icon-xihuan"></i></a>&nbsp;<a href=https://no-sky.github.io>Note</a></div><div class="menu navbar-right"><a class=menu-item href=/posts/>Blog</a>
<a class=menu-item href=/tags/>Tags</a>
<a class=menu-item href=/about/>About</a></div></div></nav><nav class=navbar-mobile id=nav-mobile style=display:none><div class=container><div class=navbar-header><div><a href=javascript:void(0); class=theme-switch><i class="iconfont icon-xihuan"></i></a>&nbsp;<a href=https://no-sky.github.io>Note</a></div><div class=menu-toggle><span></span><span></span><span></span></div></div><div class=menu id=mobile-menu><a class=menu-item href=/posts/>Blog</a>
<a class=menu-item href=/tags/>Tags</a>
<a class=menu-item href=/about/>About</a></div></div></nav><main class=main><div class=container><article class=post-warp itemscope itemtype=http://schema.org/Article><header class=post-header><h1 class=post-title itemprop="name headline">Oracle笔记 （七）</h1><div class=post-meta>Written by <a itemprop=name href=https://no-sky.github.io rel=author>nosky</a> with ♥
<span class=post-time>on <time datetime=2017-11-27 itemprop=datePublished>November 27, 2017</time></span>
in</div></header><div class=post-content><h1 id=heading>多表连接（二）、组函数、分组查询</h1><h2 id=heading1>一、不等连接</h2><p><strong>拿一个表作为另一表的查询条件或范围</strong></p><p>如：显示雇员名称，工资和所属工资等级。</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-SQL data-lang=SQL><span style=color:#66d9ef>select</span> e.ename,e.sal,s.grade <span style=color:#66d9ef>from</span> emp e,salgrade s <span style=color:#66d9ef>where</span> e.sal <span style=color:#66d9ef>between</span> s.losal <span style=color:#66d9ef>and</span> s.hisal;
</code></pre></div><h2 id=heading2>二、自连接</h2><p><strong>自连接就是一个表，同本身进行连接。对于自连接可以想像存在两个相同的表(表和表的副本)，可以通过不同的别名区别两个相同的表（其它就是内连接)</strong></p><p>如：显示雇员名称和雇员的经理名称</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-SQL data-lang=SQL><span style=color:#66d9ef>select</span> worker.ename<span style=color:#f92672>|</span><span style=color:#f92672>|</span><span style=color:#e6db74>&#39;</span><span style=color:#e6db74>的经理是</span><span style=color:#e6db74>&#39;</span><span style=color:#f92672>|</span><span style=color:#f92672>|</span>manager.ename <span style=color:#66d9ef>as</span> <span style=color:#960050;background-color:#1e0010>雇</span><span style=color:#960050;background-color:#1e0010>员</span><span style=color:#960050;background-color:#1e0010>经</span><span style=color:#960050;background-color:#1e0010>理</span> <span style=color:#66d9ef>from</span> emp worker,emp manager <span style=color:#66d9ef>where</span> worker.mgr<span style=color:#f92672>=</span>manager.empno;
</code></pre></div><h2 id=heading3>三、组函数</h2><p>**
组函数只能应用于SELECT子句、HAVING子句或ORDER BY子句中。
组函数也可以称为统计函数。
组函数忽略列的空值。
对组可以应用组函数。
在组函数中可使用DISTINCT或ALL关键字。<br>ALL表示对所有非NULL值(可重复)进行运算。<br>DISTINCT 表示对每一个非NULL值，如果存在重复值，则组函数只运算一次。如果不指明上述关键字，默认为ALL。
**</p><table><thead><tr><th>函数</th><th>说明</th></tr></thead><tbody><tr><td>AVG</td><td>求平均值</td></tr><tr><td>COUNT</td><td>求计数值，返回非空行数，*表示返回所有行</td></tr><tr><td>MAX</td><td>求最大值</td></tr><tr><td>MIN</td><td>求最小值</td></tr><tr><td>SUM</td><td>求和</td></tr><tr><td>SIDDEV</td><td>求标准偏差，是根据差的平方根得到的</td></tr><tr><td>VARIANCE</td><td>求统计方差</td></tr></tbody></table><h2 id=heading4>四、分组查询</h2><p><strong>1、如：按职务统计工资总和。</strong></p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-SQL data-lang=SQL><span style=color:#66d9ef>select</span> deptno,job,<span style=color:#66d9ef>sum</span>(sal) <span style=color:#66d9ef>from</span> emp <span style=color:#66d9ef>group</span> <span style=color:#66d9ef>by</span> deptno,job;
</code></pre></div><p><strong>2、多列分组</strong></p><p>如：按部门和职务分组统计工资总和。:</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-SQL data-lang=SQL><span style=color:#66d9ef>select</span> deptno,job,<span style=color:#66d9ef>sum</span>(sal) <span style=color:#66d9ef>from</span> emp <span style=color:#66d9ef>group</span> <span style=color:#66d9ef>by</span> deptno,job;
</code></pre></div><p><strong>3、HAVING</strong>
<em>HAVING从句过滤分组后的结果，它只能出现在GROUP BY从句之后，而WHERE从句要出现在GROUP BY从句之前。</em></p><p>如：统计各部门的最高工资，排除最高工资小于3000的部门。</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-SQL data-lang=SQL><span style=color:#66d9ef>select</span> deptno,<span style=color:#66d9ef>max</span>(sal) <span style=color:#66d9ef>from</span> emp <span style=color:#66d9ef>group</span> <span style=color:#66d9ef>by</span> deptno <span style=color:#66d9ef>having</span> <span style=color:#66d9ef>max</span>(sal)<span style=color:#f92672>&gt;</span><span style=color:#f92672>=</span><span style=color:#ae81ff>3000</span>;
</code></pre></div><p><strong>4、分组统计结果排序</strong>
<em>可以使用ORDER BY从句对统计的结果进行排序，ORDER BY从句要出现在语句的最后。</em></p><p>如：按职务统计工资总和并排序。</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-SQL data-lang=SQL><span style=color:#66d9ef>select</span> job <span style=color:#960050;background-color:#1e0010>职</span><span style=color:#960050;background-color:#1e0010>务</span>, <span style=color:#66d9ef>sum</span>(sal) <span style=color:#960050;background-color:#1e0010>工</span><span style=color:#960050;background-color:#1e0010>资</span><span style=color:#960050;background-color:#1e0010>总</span><span style=color:#960050;background-color:#1e0010>和</span> <span style=color:#66d9ef>from</span> emp <span style=color:#66d9ef>group</span> <span style=color:#66d9ef>by</span> job <span style=color:#66d9ef>order</span> <span style=color:#66d9ef>by</span> <span style=color:#66d9ef>sum</span>(sal);
</code></pre></div><p><strong>5、组函数的嵌套使用</strong></p><p>如：求各部门平均工资的最高值。</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-SQL data-lang=SQL><span style=color:#66d9ef>select</span> <span style=color:#66d9ef>max</span>(<span style=color:#66d9ef>avg</span>(sal)) <span style=color:#66d9ef>from</span> emp <span style=color:#66d9ef>group</span> <span style=color:#66d9ef>by</span> deptno;
</code></pre></div></div><div class=post-copyright><p class=copyright-item><span>Author:</span>
<span>nosky</span></p><p class=copyright-item><span>Link:</span>
<a href=https://no-sky.github.io/2017/oracle%E7%AC%94%E8%AE%B0-%E4%B8%83/>https://no-sky.github.io/2017/oracle%E7%AC%94%E8%AE%B0-%E4%B8%83/</span></p><p class="copyright-item lincese">本文采用<a rel=license href=http://creativecommons.org/licenses/by-nc/4.0/ target=_blank>知识共享署名-非商业性使用 4.0 国际许可协议</a>进行许可</p></div><div class=post-tags><section><i class="iconfont icon-tag"></i>Tag(s):
<span class=tag><a href=https://no-sky.github.io/tags/oracel/>#oracel</a></span></section><section><a href=javascript:window.history.back();>back</a></span> ·
<span><a href=https://no-sky.github.io>home</a></span></section></div><div class=post-nav><a href=https://no-sky.github.io/2017/oracle%E7%AC%94%E8%AE%B0-%E5%85%AD/ class=prev rel=prev title="Oracle笔记 （六）"><i class="iconfont icon-left"></i>&nbsp;Oracle笔记 （六）</a>
<a href=https://no-sky.github.io/2017/oracle%E7%AC%94%E8%AE%B0-%E5%85%AB/ class=next rel=next title="Oracle笔记 （八）">Oracle笔记 （八）&nbsp;<i class="iconfont icon-right"></i></a></div><div class=post-comment></div></article></div></main><footer class=footer><div class=copyright>&copy;
<span itemprop=copyrightYear>2016 - 2019</span>
<span class=with-love><i class="iconfont icon-love"></i></span><span class=author itemprop=copyrightHolder><a href=https://no-sky.github.io>nosky</a> |</span>
<a href=http://www.miibeian.gov.cn/ target=_blank rel="external nofollow">湘ICP备19027112号</a> |
<span>Powered by <a href=https://gohugo.io/ target=_blank rel="external nofollow">Hugo</a> & <a href=https://github.com/liuzc/leaveit target=_blank rel="external nofollow">LeaveIt</a></span></br><span><a href=https://www.upyun.com/><img style=width:80px;height:30px;background-color:#70847d src=/images/upyun.png alt></a></span></div></footer><script src=/js/vendor_no_gallery.min.js async></script></div></body></html>