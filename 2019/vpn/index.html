<!doctype html><html lang=en-us><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="chrome=1"><meta name=viewport content="width=device-width,initial-scale=1"><link rel="shortcut icon" href=https://no-sky.github.io/images/favicon.ico><meta name=robots content="noodp"><meta name=author content="nosky"><meta name=description content="nosky 的个人学习笔记"><meta name=keywords content="[note 笔记 nosky]"><link rel=prev href=https://no-sky.github.io/2019/cdn/><link rel=next href=https://no-sky.github.io/2019/mobilenetwork/><link rel=canonical href=https://no-sky.github.io/2019/vpn/><meta name=msapplication-TileColor content="#da532c"><meta name=theme-color content="#ffffff"><title>VPN | Note</title><meta name=title content="VPN | Note"><link rel=stylesheet href=/font/iconfont.css><link rel=stylesheet href=/css/main.min.css><script type=application/ld+json>{"@context":"http://schema.org","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"https:\/\/no-sky.github.io"},"articleSection":"posts","name":"VPN","headline":"VPN","description":"连接多个数据中心的方式：  走公网，最简单但不安全 专线连接，成本高昂，效率高 VPN 连接，简单便宜，保证私密性，性能稍差  VPN ，全名 Virtual Private Network ， 虚拟专用网 ，就是利用开放的公众网络，建立专用数据传输通道，将远程的分支机构、移动办公人员等连接起来。\nVPN是如何工作的？ VPN通过隧道技术在公众网络上仿真一条点到点的专线，是通过利用一种协议来传输另外一种协议的技术，这里面涉及三种协议： 乘客协议 、 隧道协议 和 承载协议 。 我们以IPsec协议为例来说明。\nIPSec VPN「Virtual Private Network」工作原理：  将要发送的 IP 包「乘客协议」加密后加上 IPSec 包头「隧道协议」后再放入另一个 IP 包「承载协议」中发送    IPSec VPN 是基于 IP 协议的安全隧道协议，采用一些机制保证安全性\n  私密性：加密数据\n  完整性：对数据进行 hash 运算产生数据摘要\n  真实性：通过身份认证保证对端身份的真实性\n    IPSec VPN 协议簇包括：   两种协议：\n  AH「Authentication Header」：只能进行数据摘要，不能实现数据加密\n  ESP「Encapsulating Security Payload」：能够进行数据加密和数据摘要","inLanguage":"en-us","author":"nosky","creator":"nosky","publisher":"nosky","accountablePerson":"nosky","copyrightHolder":"nosky","copyrightYear":"2019","datePublished":"2019-12-04 17:39:04 \x2b0800 \x2b0800","dateModified":"2019-12-04 17:39:04 \x2b0800 \x2b0800","url":"https:\/\/no-sky.github.io\/2019\/vpn\/","wordCount":"136","keywords":["Network Protocol","Note"]}</script><script type=text/javascript async src="https://cdn.bootcss.com/mathjax/2.7.3/MathJax.js?config=TeX-AMS-MML_HTMLorMML">MathJax.Hub.Config({tex2jax:{inlineMath:[['$','$'],['\\(','\\)']],displayMath:[['$$','$$'],['\[','\]']],processEscapes:true,processEnvironments:true,skipTags:['script','noscript','style','textarea','pre'],TeX:{equationNumbers:{autoNumber:"AMS"},extensions:["AMSmath.js","AMSsymbols.js"]}},"HTML-CSS":{linebreaks:{automatic:true}},SVG:{linebreaks:{automatic:true}}});MathJax.Hub.Queue(function(){var all=MathJax.Hub.getAllJax(),i;for(i=0;i<all.length;i+=1){all[i].SourceElement().parentNode.className+=' has-jax';}});</script><style>code.has-jax{font:inherit;font-size:100%;background:inherit;border:inherit;color:#515151}</style></head><body><div class=wrapper><nav class=navbar><div class=container><div class="navbar-header header-logo"><a href=javascript:void(0); class=theme-switch><i class="iconfont icon-xihuan"></i></a>&nbsp;<a href=https://no-sky.github.io>Note</a></div><div class="menu navbar-right"><a class=menu-item href=/posts/>Blog</a>
<a class=menu-item href=/tags/>Tags</a>
<a class=menu-item href=/about/>About</a></div></div></nav><nav class=navbar-mobile id=nav-mobile style=display:none><div class=container><div class=navbar-header><div><a href=javascript:void(0); class=theme-switch><i class="iconfont icon-xihuan"></i></a>&nbsp;<a href=https://no-sky.github.io>Note</a></div><div class=menu-toggle><span></span><span></span><span></span></div></div><div class=menu id=mobile-menu><a class=menu-item href=/posts/>Blog</a>
<a class=menu-item href=/tags/>Tags</a>
<a class=menu-item href=/about/>About</a></div></div></nav><main class=main><div class=container><article class=post-warp itemscope itemtype=http://schema.org/Article><header class=post-header><h1 class=post-title itemprop="name headline">VPN</h1><div class=post-meta>Written by <a itemprop=name href=https://no-sky.github.io rel=author>nosky</a> with ♥
<span class=post-time>on <time datetime=2019-12-04 itemprop=datePublished>December 4, 2019</time></span>
in</div></header><div class=post-content><h2 id=heading>连接多个数据中心的方式：</h2><ul><li>走公网，最简单但不安全</li><li>专线连接，成本高昂，效率高</li><li>VPN 连接，简单便宜，保证私密性，性能稍差</li></ul><p><strong>VPN ，全名 Virtual Private Network ， 虚拟专用网 ，就是利用开放的公众网络，建立专用数据传输通道，将远程的分支机构、移动办公人员等连接起来。</strong></p><h2 id=vpn>VPN是如何工作的？</h2><p>VPN通过隧道技术在公众网络上仿真一条点到点的专线，是通过利用一种协议来传输另外一种协议的技术，这里面涉及三种协议： 乘客协议 、 隧道协议 和 承载协议 。
我们以IPsec协议为例来说明。</p><h2 id=ipsec-vpnvirtual-private-network>IPSec VPN「Virtual Private Network」工作原理：</h2><ul><li>将要发送的 IP 包「乘客协议」加密后加上 IPSec 包头「隧道协议」后再放入另一个 IP 包「承载协议」中发送</li></ul><p><img src=https://mubu.com/document_image/9a172e1e-5204-4c06-8b21-2baeb957a4e2-963664.jpg alt=img></p><ul><li><p>IPSec VPN 是基于 IP 协议的安全隧道协议，采用一些机制保证安全性</p><ul><li><p>私密性：加密数据</p></li><li><p>完整性：对数据进行 hash 运算产生数据摘要</p></li><li><p>真实性：通过身份认证保证对端身份的真实性</p></li></ul></li></ul><h2 id=ipsec-vpn->IPSec VPN 协议簇包括：</h2><ul><li><p>两种协议：</p><ul><li><p>AH「Authentication Header」：只能进行数据摘要，不能实现数据加密</p></li><li><p>ESP「Encapsulating Security Payload」：能够进行数据加密和数据摘要</p></li></ul></li><li><p>两种算法：</p><ul><li><p>加密算法</p></li><li><p>摘要算法</p></li></ul></li><li><p>两大组件：</p><ul><li><p>IKE「Internet Key Exchange Key Management」：用于交换对称秘钥</p></li><li><p>SA「Security Association」：进行连接维护</p></li></ul></li></ul><h2 id=ipsec-vpn-1>IPsec VPN 的建立过程：</h2><ul><li><p>建立 IKE 自己的 SA，算出对称秘钥 K</p></li><li><p>使用对称秘钥 K 建立 IPSec SA，在 SA 中生成随机对称秘钥 M，使用 M 进行双方接下来的通信</p></li></ul><h2 id=heading1>扩展</h2><ul><li><p>IP 协议：</p><ul><li><p>不是面向连接的，是尽力而为的协议，每个 IP 包自由选择路径，依赖于上一层 TCP 的重发来保证可靠性</p></li><li><p>优点：一条道路崩溃时，可以自动换其他路</p></li><li><p>缺点：不断的路由查找，效率低下</p></li></ul></li><li><p>IPSec VPN 的缺点：</p><ul><li>由于 IPSec VPN 是基于 IP 协议的，所以速度慢</li></ul></li><li><p>ATM 协议：</p><ul><li><p>这种协议是面向连接的，并且和 IP 是同一个层次，ATM 是在传输之前先建立一个连接，形成一个虚拟的通路</p></li><li><p>优点：速度快，因为按照指定路径传输</p></li><li><p>缺点：当某个节点故障，连接就会中断，无法传输数据</p></li></ul></li><li><p>多协议标签交换「MPLS，Multi-Protocol Label Switching」</p><ul><li><p>结合了 IP 和 ATM 协议的优点</p></li><li><p>需要标签交换路由器「LSR，Label Switching Router」的支持</p></li><li><p>如何动态生成标签 LDP「Label Distribution Protocol」</p></li><li><p>将 MPLS 和 VPN 结合起来可以提高 VPN 的效率</p></li></ul></li><li><p>需要解决的问题有：</p><ul><li><p>BGP 协议如何处理地址空间重叠的 VPN 的路由</p></li><li><p>路由表怎么区分重复的网段</p></li></ul></li></ul></div><div class=post-copyright><p class=copyright-item><span>Author:</span>
<span>nosky</span></p><p class=copyright-item><span>Link:</span>
<a href=https://no-sky.github.io/2019/vpn/>https://no-sky.github.io/2019/vpn/</span></p><p class="copyright-item lincese">本文采用<a rel=license href=http://creativecommons.org/licenses/by-nc/4.0/ target=_blank>知识共享署名-非商业性使用 4.0 国际许可协议</a>进行许可</p></div><div class=post-tags><section><i class="iconfont icon-tag"></i>Tag(s):
<span class=tag><a href=https://no-sky.github.io/tags/network-protocol/>#Network Protocol</a></span></section><section><a href=javascript:window.history.back();>back</a></span> ·
<span><a href=https://no-sky.github.io>home</a></span></section></div><div class=post-nav><a href=https://no-sky.github.io/2019/cdn/ class=prev rel=prev title=CDN><i class="iconfont icon-left"></i>&nbsp;CDN</a>
<a href=https://no-sky.github.io/2019/mobilenetwork/ class=next rel=next title=移动网络>移动网络&nbsp;<i class="iconfont icon-right"></i></a></div><div class=post-comment></div></article></div></main><footer class=footer><div class=copyright>&copy;
<span itemprop=copyrightYear>2016 - 2020</span>
<span class=with-love><i class="iconfont icon-love"></i></span><span class=author itemprop=copyrightHolder><a href=https://no-sky.github.io>nosky</a> |</span>
<a href=http://beian.miit.gov.cn/ target=_blank rel="external nofollow">>湘ICP备19027112号</a> |
<span>Powered by <a href=https://gohugo.io/ target=_blank rel="external nofollow">Hugo</a> & <a href=https://github.com/liuzc/leaveit target=_blank rel="external nofollow">LeaveIt</a></span></br><span><a href=https://www.upyun.com/><img style=width:80px;height:30px;background-color:#70847d src=/images/upyun.png alt></a></span></div></footer><link href=//lib.baomitu.com/lightgallery/1.6.11/css/lightgallery.min.css rel=stylesheet><script src=/js/vendor_gallery.min.js async></script></div></body></html>